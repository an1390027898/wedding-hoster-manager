# 主持人管家跨设备访问方案

当手机和电脑不在同一网络时，您可以通过以下几种方式访问主持人管家网页程序：

## 方案一：部署到云存储服务（永久访问）

将网站部署到免费的云存储服务，获得一个公共URL，可在任何设备上访问。

### 1. 使用 GitHub Pages

**步骤：**
1. 注册GitHub账号并创建新仓库（如：`wedding-host-manager`）
2. 将项目文件上传到GitHub仓库
3. 在仓库设置中启用GitHub Pages：
   - 选择「Settings」→「Pages」
   - 选择「main」分支，点击「Save」
4. 等待几分钟，即可通过 `https://您的用户名.github.io/wedding-host-manager/` 访问

### 2. 使用 Vercel（推荐）

**步骤：**
1. 注册Vercel账号
2. 连接GitHub仓库或直接上传项目文件
3. Vercel会自动部署，生成公共URL
4. 可通过 `https://wedding-host-manager.vercel.app` 访问

## 方案二：使用内网穿透工具（临时访问）

适合临时需要从外部网络访问的场景。

### 1. 使用 ngrok

**步骤：**
1. 下载并安装 ngrok：https://ngrok.com/download
2. 注册账号并获取认证令牌
3. 在命令行中运行：
   ```
   ngrok config add-authtoken 您的认证令牌
   ngrok http 8000
   ```
4. 获得类似 `https://xxxx-xx-xx-xx-xx.ngrok-free.app` 的公共URL
5. 在手机上访问该URL即可

### 2. 使用 localtunnel

**步骤：**
1. 安装 localtunnel：
   ```
   npm install -g localtunnel
   ```
2. 启动本地服务器：
   ```
   node server.js
   ```
3. 在新的命令行中运行：
   ```
   lt --port 8000
   ```
4. 获得公共URL，在手机上访问

## 方案三：优化数据同步功能

增强现有的数据导出/导入功能，让您可以更方便地在不同设备间同步数据。

### 代码优化（自动备份到云端）

添加云存储支持，使用 Firebase 实时数据库或 Supabase：

**步骤：**
1. 注册 Firebase 账号并创建项目
2. 在项目设置中获取配置信息
3. 在 `index.html` 中添加 Firebase SDK
4. 修改数据存储逻辑，同时保存到 localStorage 和云端

**核心代码示例：**

```javascript
// 初始化 Firebase
const firebaseConfig = {
  apiKey: "您的API密钥",
  authDomain: "您的项目ID.firebaseapp.com",
  databaseURL: "https://您的项目ID-default-rtdb.firebaseio.com",
  projectId: "您的项目ID",
  storageBucket: "您的项目ID.appspot.com",
  messagingSenderId: "您的发送者ID",
  appId: "您的应用ID"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();

// 优化保存数据函数
function saveData() {
  // 保存到本地存储
  localStorage.setItem('weddingHostEvents', JSON.stringify(AppState.events));
  localStorage.setItem('weddingHostClients', JSON.stringify(AppState.clients));
  // ... 其他本地存储操作
  
  // 保存到云端（可选，需用户授权）
  if (AppState.enableCloudSync) {
    const exportData = {
      events: AppState.events,
      clients: AppState.clients,
      music: AppState.music,
      // ... 其他数据
      lastSync: new Date().toISOString()
    };
    database.ref('userData/' + AppState.userId).set(exportData);
  }
}

// 从云端加载数据
function loadFromCloud() {
  return database.ref('userData/' + AppState.userId).once('value')
    .then(snapshot => {
      const data = snapshot.val();
      if (data) {
        // 更新本地数据
        AppState.events = data.events || [];
        AppState.clients = data.clients || [];
        // ... 其他数据
        saveData(); // 保存到本地存储
        return true;
      }
      return false;
    });
}
```

### 一键同步功能

在界面上添加一键同步按钮，方便用户手动同步数据：

```html
<!-- 在工具栏中添加同步按钮 -->
<button class="btn btn-info" id="syncDataBtn">
  <i class="fas fa-sync-alt"></i> 同步数据
</button>

<script>
// 同步数据按钮事件
document.getElementById('syncDataBtn').addEventListener('click', function() {
  if (AppState.enableCloudSync) {
    loadFromCloud().then(success => {
      if (success) {
        alert('数据同步成功！');
        // 重新渲染界面
        renderCalendar();
        renderEventsList();
      } else {
        alert('云端无数据或同步失败！');
      }
    });
  } else {
    alert('请先启用云同步功能！');
  }
});
</script>
```

## 方案四：使用 WebDAV 同步

对于熟悉技术的用户，可以使用 WebDAV 服务（如坚果云、Nextcloud）进行数据同步：

1. 在坚果云等服务中创建 WebDAV 连接
2. 添加自动备份到 WebDAV 的功能
3. 在不同设备上通过 WebDAV 同步数据

**核心代码示例：**

```javascript
// WebDAV 配置
const webDavConfig = {
  url: 'https://dav.jianguoyun.com/dav/',
  username: '您的用户名',
  password: '您的密码',
  path: '/主持人管家数据/'
};

// 上传数据到 WebDAV
async function uploadToWebDAV() {
  const exportData = {
    events: AppState.events,
    clients: AppState.clients,
    // ... 其他数据
    lastSync: new Date().toISOString()
  };
  
  const dataStr = JSON.stringify(exportData, null, 2);
  const fileName = `wedding-host-backup-${new Date().toISOString().split('T')[0]}.json`;
  
  try {
    const response = await fetch(webDavConfig.url + webDavConfig.path + fileName, {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Basic ' + btoa(`${webDavConfig.username}:${webDavConfig.password}`)
      },
      body: dataStr
    });
    
    if (response.ok) {
      console.log('数据已上传到 WebDAV');
      return true;
    } else {
      console.error('WebDAV 上传失败:', response.status);
      return false;
    }
  } catch (error) {
    console.error('WebDAV 上传错误:', error);
    return false;
  }
}
```

## 选择建议

1. **如果需要长期稳定访问**：选择方案一，部署到云存储服务
2. **如果只是临时访问**：选择方案二，使用内网穿透工具
3. **如果需要在多个设备间同步数据**：选择方案三或四，增强数据同步功能

## 实施步骤

根据您的需求选择合适的方案，按照上述步骤实施即可。如果需要帮助，可以联系技术人员协助部署和配置。

## 注意事项

1. 部署到公共网络后，注意保护敏感数据
2. 使用内网穿透工具时，确保仅在需要时使用，并设置访问密码
3. 定期备份数据，防止数据丢失
4. 云同步功能需要注意数据隐私和安全，建议使用加密存储
